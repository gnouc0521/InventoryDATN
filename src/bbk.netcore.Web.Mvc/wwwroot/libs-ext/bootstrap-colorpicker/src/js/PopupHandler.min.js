/**
 * Minified by jsDelivr using Terser v5.9.0.
 * Original file: /npm/bootstrap-colorpicker@3.4.0/src/js/PopupHandler.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";import $ from"jquery";import _defaults from"./options";class PopupHandler{constructor(o,i){this.root=i,this.colorpicker=o,this.popoverTarget=null,this.popoverTip=null,this.clicking=!1,this.hidding=!1,this.showing=!1}get input(){return this.colorpicker.inputHandler.input}get hasInput(){return this.colorpicker.inputHandler.hasInput()}get addon(){return this.colorpicker.addonHandler.addon}get hasAddon(){return this.colorpicker.addonHandler.hasAddon()}get isPopover(){return!this.colorpicker.options.inline&&!!this.popoverTip}bind(){let o=this.colorpicker;o.options.inline?o.picker.addClass("colorpicker-inline colorpicker-visible"):(o.picker.addClass("colorpicker-popup colorpicker-hidden"),(this.hasInput||this.hasAddon)&&(o.options.popover&&this.createPopover(),this.hasAddon&&(this.addon.attr("tabindex")||this.addon.attr("tabindex",0),this.addon.on({"mousedown.colorpicker touchstart.colorpicker":$.proxy(this.toggle,this)}),this.addon.on({"focus.colorpicker":$.proxy(this.show,this)}),this.addon.on({"focusout.colorpicker":$.proxy(this.hide,this)})),this.hasInput&&!this.hasAddon&&(this.input.on({"mousedown.colorpicker touchstart.colorpicker":$.proxy(this.show,this),"focus.colorpicker":$.proxy(this.show,this)}),this.input.on({"focusout.colorpicker":$.proxy(this.hide,this)})),$(this.root).on("resize.colorpicker",$.proxy(this.reposition,this))))}unbind(){this.hasInput&&(this.input.off({"mousedown.colorpicker touchstart.colorpicker":$.proxy(this.show,this),"focus.colorpicker":$.proxy(this.show,this)}),this.input.off({"focusout.colorpicker":$.proxy(this.hide,this)})),this.hasAddon&&(this.addon.off({"mousedown.colorpicker touchstart.colorpicker":$.proxy(this.toggle,this)}),this.addon.off({"focus.colorpicker":$.proxy(this.show,this)}),this.addon.off({"focusout.colorpicker":$.proxy(this.hide,this)})),this.popoverTarget&&this.popoverTarget.popover("dispose"),$(this.root).off("resize.colorpicker",$.proxy(this.reposition,this)),$(this.root.document).off("mousedown.colorpicker touchstart.colorpicker",$.proxy(this.hide,this)),$(this.root.document).off("mousedown.colorpicker touchstart.colorpicker",$.proxy(this.onClickingInside,this))}isClickingInside(o){return!!o&&(this.isOrIsInside(this.popoverTip,o.currentTarget)||this.isOrIsInside(this.popoverTip,o.target)||this.isOrIsInside(this.colorpicker.picker,o.currentTarget)||this.isOrIsInside(this.colorpicker.picker,o.target))}isOrIsInside(o,i){return!(!o||!i)&&((i=$(i)).is(o)||o.find(i).length>0)}onClickingInside(o){this.clicking=this.isClickingInside(o)}createPopover(){let o=this.colorpicker;this.popoverTarget=this.hasAddon?this.addon:this.input,o.picker.addClass("colorpicker-bs-popover-content"),this.popoverTarget.popover($.extend(!0,{},_defaults.popover,o.options.popover,{trigger:"manual",content:o.picker,html:!0}));const i=window.bootstrap&&window.bootstrap.Popover&&window.bootstrap.Popover.getInstance;this.popoverTip=$(i?bootstrap.Popover.getInstance(this.popoverTarget[0]).getTipElement():this.popoverTarget.popover("getTipElement").data("bs.popover").tip),this.popoverTip.addClass("colorpicker-bs-popover"),this.popoverTarget.on("shown.bs.popover",$.proxy(this.fireShow,this)),this.popoverTarget.on("hidden.bs.popover",$.proxy(this.fireHide,this))}reposition(o){this.popoverTarget&&this.isVisible()&&this.popoverTarget.popover("update")}toggle(o){this.isVisible()?this.hide(o):this.show(o)}show(o){if(this.isVisible()||this.showing||this.hidding)return;this.showing=!0,this.hidding=!1,this.clicking=!1;let i=this.colorpicker;i.lastEvent.alias="show",i.lastEvent.e=o,o&&(!this.hasInput||"color"===this.input.attr("type"))&&o&&o.preventDefault&&(o.stopPropagation(),o.preventDefault()),this.isPopover&&$(this.root).on("resize.colorpicker",$.proxy(this.reposition,this)),i.picker.addClass("colorpicker-visible").removeClass("colorpicker-hidden"),this.popoverTarget?this.popoverTarget.popover("show"):this.fireShow()}fireShow(){this.hidding=!1,this.showing=!1,this.isPopover&&($(this.root.document).on("mousedown.colorpicker touchstart.colorpicker",$.proxy(this.hide,this)),$(this.root.document).on("mousedown.colorpicker touchstart.colorpicker",$.proxy(this.onClickingInside,this))),this.colorpicker.trigger("colorpickerShow")}hide(o){if(this.isHidden()||this.showing||this.hidding)return;let i=this.colorpicker,t=this.clicking||this.isClickingInside(o);this.hidding=!0,this.showing=!1,this.clicking=!1,i.lastEvent.alias="hide",i.lastEvent.e=o,t?this.hidding=!1:this.popoverTarget?this.popoverTarget.popover("hide"):this.fireHide()}fireHide(){this.hidding=!1,this.showing=!1;let o=this.colorpicker;o.picker.addClass("colorpicker-hidden").removeClass("colorpicker-visible"),$(this.root).off("resize.colorpicker",$.proxy(this.reposition,this)),$(this.root.document).off("mousedown.colorpicker touchstart.colorpicker",$.proxy(this.hide,this)),$(this.root.document).off("mousedown.colorpicker touchstart.colorpicker",$.proxy(this.onClickingInside,this)),o.trigger("colorpickerHide")}focus(){return this.hasAddon?this.addon.focus():!!this.hasInput&&this.input.focus()}isVisible(){return this.colorpicker.picker.hasClass("colorpicker-visible")&&!this.colorpicker.picker.hasClass("colorpicker-hidden")}isHidden(){return this.colorpicker.picker.hasClass("colorpicker-hidden")&&!this.colorpicker.picker.hasClass("colorpicker-visible")}}export default PopupHandler;
//# sourceMappingURL=/sm/2d7e790c6804ed92d20eeab2f6dd6011d8253a91a23ce8f70c4fe50a83928ef8.map