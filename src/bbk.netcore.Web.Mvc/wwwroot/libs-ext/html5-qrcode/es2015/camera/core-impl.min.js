/**
 * Minified by jsDelivr using Terser v5.15.1.
 * Original file: /npm/html5-qrcode@2.3.4/es2015/camera/core-impl.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __awaiter=this&&this.__awaiter||function(e,t,a,i){return new(a||(a=Promise))((function(r,s){function n(e){try{c(i.next(e))}catch(e){s(e)}}function o(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(n,o)}c((i=i.apply(e,t||[])).next())}))};class AbstractCameraCapability{constructor(e,t){this.name=e,this.track=t}isSupported(){return!!this.track.getCapabilities&&this.name in this.track.getCapabilities()}apply(e){let t={};t[this.name]=e;let a={advanced:[t]};return this.track.applyConstraints(a)}value(){let e=this.track.getSettings();if(this.name in e){return e[this.name]}return null}}class AbstractRangeCameraCapability extends AbstractCameraCapability{constructor(e,t){super(e,t)}min(){return this.getCapabilities().min}max(){return this.getCapabilities().max}step(){return this.getCapabilities().step}apply(e){let t={};t[this.name]=e;let a={advanced:[t]};return this.track.applyConstraints(a)}getCapabilities(){this.failIfNotSupported();let e=this.track.getCapabilities()[this.name];return{min:e.min,max:e.max,step:e.step}}failIfNotSupported(){if(!this.isSupported())throw new Error(`${this.name} capability not supported`)}}class ZoomFeatureImpl extends AbstractRangeCameraCapability{constructor(e){super("zoom",e)}}class TorchFeatureImpl extends AbstractCameraCapability{constructor(e){super("torch",e)}}class CameraCapabilitiesImpl{constructor(e){this.track=e}zoomFeature(){return new ZoomFeatureImpl(this.track)}torchFeature(){return new TorchFeatureImpl(this.track)}}class RenderedCameraImpl{constructor(e,t,a){this.isClosed=!1,this.parentElement=e,this.mediaStream=t,this.callbacks=a,this.surface=this.createVideoElement(this.parentElement.clientWidth),e.append(this.surface)}createVideoElement(e){const t=document.createElement("video");return t.style.width=`${e}px`,t.style.display="block",t.muted=!0,t.setAttribute("muted","true"),t.playsInline=!0,t}setupSurface(){this.surface.onabort=()=>{throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=()=>{throw"RenderedCameraImpl video surface onerror() called"};let e=()=>{const t=this.surface.clientWidth,a=this.surface.clientHeight;this.callbacks.onRenderSurfaceReady(t,a),this.surface.removeEventListener("playing",e)};this.surface.addEventListener("playing",e),this.surface.srcObject=this.mediaStream,this.surface.play()}static create(e,t,a,i){return __awaiter(this,void 0,void 0,(function*(){let r=new RenderedCameraImpl(e,t,i);if(a.aspectRatio){let e={aspectRatio:a.aspectRatio};yield r.getFirstTrackOrFail().applyConstraints(e)}return r.setupSurface(),r}))}failIfClosed(){if(this.isClosed)throw"The RenderedCamera has already been closed."}getFirstTrackOrFail(){if(this.failIfClosed(),0===this.mediaStream.getVideoTracks().length)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]}pause(){this.failIfClosed(),this.surface.pause()}resume(e){this.failIfClosed();let t=this;const a=()=>{setTimeout(e,200),t.surface.removeEventListener("playing",a)};this.surface.addEventListener("playing",a),this.surface.play()}isPaused(){return this.failIfClosed(),this.surface.paused}getSurface(){return this.failIfClosed(),this.surface}getRunningTrackCapabilities(){return this.getFirstTrackOrFail().getCapabilities()}getRunningTrackSettings(){return this.getFirstTrackOrFail().getSettings()}applyVideoConstraints(e){return __awaiter(this,void 0,void 0,(function*(){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return this.getFirstTrackOrFail().applyConstraints(e)}))}close(){if(this.isClosed)return Promise.resolve();let e=this;return new Promise(((t,a)=>{const i=e.mediaStream.getVideoTracks().length;var r=0;e.mediaStream.getVideoTracks().forEach((a=>{e.mediaStream.removeTrack(a),a.stop(),++r>=i&&(e.isClosed=!0,e.parentElement.removeChild(e.surface),t())}))}))}getCapabilities(){return new CameraCapabilitiesImpl(this.getFirstTrackOrFail())}}export class CameraImpl{constructor(e){this.mediaStream=e}render(e,t,a){return __awaiter(this,void 0,void 0,(function*(){return RenderedCameraImpl.create(e,this.mediaStream,t,a)}))}static create(e){return __awaiter(this,void 0,void 0,(function*(){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";let t={audio:!1,video:e},a=yield navigator.mediaDevices.getUserMedia(t);return new CameraImpl(a)}))}}
//# sourceMappingURL=/sm/a76213735bc0efd3931a1a43411bb4aee2e5408dc36622b4e83d603bb8bf4005.map