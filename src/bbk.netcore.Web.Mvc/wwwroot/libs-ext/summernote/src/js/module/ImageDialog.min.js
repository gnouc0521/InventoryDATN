/**
 * Minified by jsDelivr using Terser v5.9.0.
 * Original file: /npm/summernote@0.8.20/src/js/module/ImageDialog.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import $ from"jquery";import env from"../core/env";import key from"../core/key";export default class ImageDialog{constructor(i){this.context=i,this.ui=$.summernote.ui,this.$body=$(document.body),this.$editor=i.layoutInfo.editor,this.options=i.options,this.lang=this.options.langInfo}initialize(){let i="";if(this.options.maximumImageFileSize){const t=Math.floor(Math.log(this.options.maximumImageFileSize)/Math.log(1024)),e=1*(this.options.maximumImageFileSize/Math.pow(1024,t)).toFixed(2)+" "+" KMGTP"[t]+"B";i=`<small>${this.lang.image.maximumFileSize+" : "+e}</small>`}const t=this.options.dialogsInBody?this.$body:this.options.container,e=['<div class="form-group note-form-group note-group-select-from-files">','<label for="note-dialog-image-file-'+this.options.id+'" class="note-form-label">'+this.lang.image.selectFromFiles+"</label>",'<input id="note-dialog-image-file-'+this.options.id+'" class="note-image-input form-control-file note-form-control note-input" ',' type="file" name="files" accept="'+this.options.acceptImageFileTypes+'" multiple="multiple"/>',i,"</div>",'<div class="form-group note-group-image-url">','<label for="note-dialog-image-url-'+this.options.id+'" class="note-form-label">'+this.lang.image.url+"</label>",'<input id="note-dialog-image-url-'+this.options.id+'" class="note-image-url form-control note-form-control note-input" type="text"/>',"</div>"].join(""),o=`<input type="button" href="#" class="btn btn-primary note-btn note-btn-primary note-image-btn" value="${this.lang.image.insert}" disabled>`;this.$dialog=this.ui.dialog({title:this.lang.image.insert,fade:this.options.dialogsFade,body:e,footer:o}).render().appendTo(t)}destroy(){this.ui.hideDialog(this.$dialog),this.$dialog.remove()}bindEnterKey(i,t){i.on("keypress",(i=>{i.keyCode===key.code.ENTER&&(i.preventDefault(),t.trigger("click"))}))}show(){this.context.invoke("editor.saveRange"),this.showImageDialog().then((i=>{this.ui.hideDialog(this.$dialog),this.context.invoke("editor.restoreRange"),"string"==typeof i?this.options.callbacks.onImageLinkInsert?this.context.triggerEvent("image.link.insert",i):this.context.invoke("editor.insertImage",i):this.context.invoke("editor.insertImagesOrCallback",i)})).fail((()=>{this.context.invoke("editor.restoreRange")}))}showImageDialog(){return $.Deferred((i=>{const t=this.$dialog.find(".note-image-input"),e=this.$dialog.find(".note-image-url"),o=this.$dialog.find(".note-image-btn");this.ui.onDialogShown(this.$dialog,(()=>{this.context.triggerEvent("dialog.shown"),t.replaceWith(t.clone().on("change",(t=>{i.resolve(t.target.files||t.target.value)})).val("")),e.on("input paste propertychange",(()=>{this.ui.toggleBtn(o,e.val())})).val(""),env.isSupportTouch||e.trigger("focus"),o.click((t=>{t.preventDefault(),i.resolve(e.val())})),this.bindEnterKey(e,o)})),this.ui.onDialogHidden(this.$dialog,(()=>{t.off(),e.off(),o.off(),"pending"===i.state()&&i.reject()})),this.ui.showDialog(this.$dialog)}))}}
//# sourceMappingURL=/sm/04dbf50a2100fc87cb2c005f2966ddc6ae81e72169f7729b4b905a97c2bdced1.map