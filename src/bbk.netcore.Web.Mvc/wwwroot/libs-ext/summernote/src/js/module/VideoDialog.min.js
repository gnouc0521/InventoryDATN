/**
 * Minified by jsDelivr using Terser v5.9.0.
 * Original file: /npm/summernote@0.8.20/src/js/module/VideoDialog.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import $ from"jquery";import env from"../core/env";import key from"../core/key";export default class VideoDialog{constructor(t){this.context=t,this.ui=$.summernote.ui,this.$body=$(document.body),this.$editor=t.layoutInfo.editor,this.options=t.options,this.lang=this.options.langInfo}initialize(){const t=this.options.dialogsInBody?this.$body:this.options.container,e=['<div class="form-group note-form-group row-fluid">',`<label for="note-dialog-video-url-${this.options.id}" class="note-form-label">${this.lang.video.url} <small class="text-muted">${this.lang.video.providers}</small></label>`,`<input id="note-dialog-video-url-${this.options.id}" class="note-video-url form-control note-form-control note-input" type="text"/>`,"</div>"].join(""),o=`<input type="button" href="#" class="btn btn-primary note-btn note-btn-primary note-video-btn" value="${this.lang.video.insert}" disabled>`;this.$dialog=this.ui.dialog({title:this.lang.video.insert,fade:this.options.dialogsFade,body:e,footer:o}).render().appendTo(t)}destroy(){this.ui.hideDialog(this.$dialog),this.$dialog.remove()}bindEnterKey(t,e){t.on("keypress",(t=>{t.keyCode===key.code.ENTER&&(t.preventDefault(),e.trigger("click"))}))}createVideoNode(t){const e=/^(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?$/,o=t.match(/\/\/(?:(?:www|m)\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([\w|-]{11})(?:(?:[\?&]t=)(\S+))?$/),i=t.match(/(?:\.|\/\/)drive\.google\.com\/file\/d\/(.[a-zA-Z0-9_-]*)\/view/),r=t.match(/(?:www\.|\/\/)instagram\.com\/p\/(.[a-zA-Z0-9_-]*)/),a=t.match(/\/\/vine\.co\/v\/([a-zA-Z0-9]+)/),l=t.match(/\/\/(player\.)?vimeo\.com\/([a-z]*\/)*(\d+)[?]?.*/),n=t.match(/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/),s=t.match(/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/),d=t.match(/\/\/(.*)\/videos\/watch\/([^?]*)(?:\?(?:start=(\w*))?(?:&stop=(\w*))?(?:&loop=([10]))?(?:&autoplay=([10]))?(?:&muted=([10]))?)?/),h=t.match(/\/\/v\.qq\.com.*?vid=(.+)/),c=t.match(/\/\/v\.qq\.com\/x?\/?(page|cover).*?\/([^\/]+)\.html\??.*/),m=t.match(/^.+.(mp4|m4v)$/),g=t.match(/^.+.(ogg|ogv)$/),f=t.match(/^.+.(webm)$/),u=t.match(/(?:www\.|\/\/)facebook\.com\/([^\/]+)\/videos\/([0-9]+)/);let v;if(o&&11===o[1].length){const t=o[1];var p=0;if(void 0!==o[2]){const t=o[2].match(e);if(t)for(var w=[3600,60,1],b=0,y=w.length;b<y;b++)p+=void 0!==t[b+1]?w[b]*parseInt(t[b+1],10):0}v=$("<iframe>").attr("frameborder",0).attr("src","//www.youtube.com/embed/"+t+(p>0?"?start="+p:"")).attr("width","640").attr("height","360")}else if(i&&i[0].length)v=$("<iframe>").attr("frameborder",0).attr("src","https://drive.google.com/file/d/"+i[1]+"/preview").attr("width","640").attr("height","480");else if(r&&r[0].length)v=$("<iframe>").attr("frameborder",0).attr("src","https://instagram.com/p/"+r[1]+"/embed/").attr("width","612").attr("height","710").attr("scrolling","no").attr("allowtransparency","true");else if(a&&a[0].length)v=$("<iframe>").attr("frameborder",0).attr("src",a[0]+"/embed/simple").attr("width","600").attr("height","600").attr("class","vine-embed");else if(l&&l[3].length)v=$("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("src","//player.vimeo.com/video/"+l[3]).attr("width","640").attr("height","360");else if(n&&n[2].length)v=$("<iframe>").attr("frameborder",0).attr("src","//www.dailymotion.com/embed/video/"+n[2]).attr("width","640").attr("height","360");else if(s&&s[1].length)v=$("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("height","498").attr("width","510").attr("src","//player.youku.com/embed/"+s[1]);else if(d&&d[0].length){var k=0;"undefined"!==d[2]&&(k=d[2]);var x=0;"undefined"!==d[3]&&(x=d[3]);var D=0;"undefined"!==d[4]&&(D=d[4]);var z=0;"undefined"!==d[5]&&(z=d[5]);var q=0;"undefined"!==d[6]&&(q=d[6]),v=$('<iframe allowfullscreen sandbox="allow-same-origin allow-scripts allow-popups">').attr("frameborder",0).attr("src","//"+d[1]+"/videos/embed/"+d[2]+"?loop="+D+"&autoplay="+z+"&muted="+q+(k>0?"&start="+k:"")+(x>0?"&end="+p:"")).attr("width","560").attr("height","315")}else if(h&&h[1].length||c&&c[2].length){const t=h&&h[1].length?h[1]:c[2];v=$("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("height","310").attr("width","500").attr("src","https://v.qq.com/txp/iframe/player.html?vid="+t+"&amp;auto=0")}else if(m||g||f)v=$("<video controls>").attr("src",t).attr("width","640").attr("height","360");else{if(!u||!u[0].length)return!1;v=$("<iframe>").attr("frameborder",0).attr("src","https://www.facebook.com/plugins/video.php?href="+encodeURIComponent(u[0])+"&show_text=0&width=560").attr("width","560").attr("height","301").attr("scrolling","no").attr("allowtransparency","true")}return v.addClass("note-video-clip"),v[0]}show(){const t=this.context.invoke("editor.getSelectedText");this.context.invoke("editor.saveRange"),this.showVideoDialog(t).then((t=>{this.ui.hideDialog(this.$dialog),this.context.invoke("editor.restoreRange");const e=this.createVideoNode(t);e&&this.context.invoke("editor.insertNode",e)})).fail((()=>{this.context.invoke("editor.restoreRange")}))}showVideoDialog(){return $.Deferred((t=>{const e=this.$dialog.find(".note-video-url"),o=this.$dialog.find(".note-video-btn");this.ui.onDialogShown(this.$dialog,(()=>{this.context.triggerEvent("dialog.shown"),e.on("input paste propertychange",(()=>{this.ui.toggleBtn(o,e.val())})),env.isSupportTouch||e.trigger("focus"),o.click((o=>{o.preventDefault(),t.resolve(e.val())})),this.bindEnterKey(e,o)})),this.ui.onDialogHidden(this.$dialog,(()=>{e.off(),o.off(),"pending"===t.state()&&t.reject()})),this.ui.showDialog(this.$dialog)}))}}
//# sourceMappingURL=/sm/49cba560c694e2f10e574014852f9bf0877226b37d9260c1390af42c804a574b.map