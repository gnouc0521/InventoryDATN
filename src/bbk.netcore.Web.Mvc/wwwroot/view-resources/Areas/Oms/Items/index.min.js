(function(){function t(){n.ajax.reload()}var f=$("#ItemsTable"),e=abp.services.app.itemsService,o=abp.services.app.inventoryService,s=abp.services.app.warehouseLocationItemService,i,r,u,n;moment.locale(abp.localization.currentLanguage.name);i=new app.ModalManager({viewUrl:abp.appPath+"Inventorys/Items/CreateItems",scriptUrl:abp.appPath+"view-resources/Areas/Oms/Items/_CreateModal.js",modalClass:"ItemsCreateModal",modalType:"modal-xl"});r=new app.ModalManager({viewUrl:abp.appPath+"Inventorys/Items/EditItemsModal",scriptUrl:abp.appPath+"view-resources/Areas/Oms/Items/_EditModal.js",modalClass:"EditItemsModal",modalType:"modal-xl"});$("#CreateNewButtonxx").click(function(){var n={wareHouseId:$("#WarehouseId").val()};i.open(n)});u=function(){let n={};return n.searchTerm=$("#SearchTerm").val().trim(),n.wareHouseId=$("#WarehouseId").val(),n};n=f.DataTable({paging:!0,serverSide:!1,processing:!0,searching:!1,language:{emptyTable:"Không tìm thấy dữ liệu",lengthMenu:"Hiển thị _MENU_ bản ghi"},bInfo:!1,bLengthChange:!0,lengthMenu:[[5,10,25,50,-1],[5,10,25,50,"Tất cả"],],pageLength:10,listAction:{ajaxFunction:e.getAll,inputFilter:u},columnDefs:[{targets:0,orderable:!1,className:"dt-body-center text-center",render:function(n,t,i){return'<input type="checkbox" name="" value="'+i.id+'">'}},{orderable:!0,targets:1,data:"itemCode"},{orderable:!1,targets:2,data:"name",render:function(n,t,i){return`
                            <a class='itemsviewfunc'  data-objid='`+i.inventoryId+`' href='javascript:void(0);'>`+i.name+` </a>`}},{orderable:!1,targets:3,data:"quantity"},{targets:4,data:"id",orderable:!1,autoWidth:!1,render:function(n,t,i){return console.log(i),`<div class='text-right'> 
                                <a class='doceditfunc text-right' data-objid='`+i.id+`'href='javascript:void(0); ' > Sửa </a>
                            </div>`}},]});$("#example-select-all").on("click",function(){var i=n.rows({search:"applied"}).nodes(),t;$('input[type="checkbox"]',i).prop("checked",this.checked);$("#DeleteAll").removeAttr("disabled");t=[];$('#ItemsTable tbody input[type="checkbox"]:checked').each(function(){t.push($(this))});t.length>0?$("#DeleteAll").removeAttr("disabled"):$("#DeleteAll").prop("disabled",!0)});$("#ItemsTable tbody").on("change",'input[type="checkbox"]',function(){var t=[],n;$('#ItemsTable tbody input[type="checkbox"]:checked').each(function(){t.push($(this))});t.length>0?$("#DeleteAll").removeAttr("disabled"):$("#DeleteAll").prop("disabled",!0);this.checked||(n=$("#example-select-all").get(0),console.log(n),n&&n.checked&&"indeterminate"in n&&(n.indeterminate=!0))});n.$('input[type="checkbox"]').each(function(n,t){t>0&&$("#DeleteAll").removeAttr("disabled")});$("#DeleteAll").on("click",function(){abp.message.confirm(app.localize("Bạn có chắc chắn muốn xóa hàng hóa"),app.localize("Xóa hàng hóa"),function(i){i&&n.$('input[type="checkbox"]').each(function(n,i){if($(i).is(":checked")){var r={},u={};r.itemId=$(i).val();r.warehouseId=$("#WarehouseId").val();u.itemId=$(i).val();u.wareHouseId=$("#WarehouseId").val();o.deleteByHa(u).done(function(){});s.delete(r).done(function(){$("#example-select-all").prop("checked",!1);abp.notify.success(app.localize("Xóa đơn hàng hóa thành công"));t()})}console.log($(i).val())})})});abp.event.on("app.reloadDocTable",function(){t()});$("#ItemsTable").on("click",".doceditfunc",function(){var n=$(this),t={id:n[0].dataset.objid,warehouseId:$("#WarehouseId").val()};r.open(t)});$("#ItemsTable").on("click",".itemsviewfunc",function(){var n=$(this),t={id:n[0].dataset.objid};abp.ajax({contentType:"application/x-www-form-urlencoded",url:abp.appPath+"Inventorys/Items/OverView?Id="+t.id,success:function(n){window.location.href="/Inventorys/Items/Detail?id="+n.id+"&WareHouseId="+$("#WarehouseId").val()}})});$("#Search").click(function(n){n.preventDefault();t()});jQuery(document).ready(function(){$("#SearchTerm").focus()})})(jQuery),function(n){app.modals.ItemsCreateModal=function(){var u=abp.services.app.itemsService,f=abp.services.app.inventoryService,t,r=null;this.init=function(u){for(n(".date-picker").datepicker({}),i=(new Date).getFullYear();i>1900;i--)n("#yearpicker").append(n("<option />").val(i).html(i));n("#Remark").summernote({height:270,forcus:!0});t=u;r=t.getModal().find("form[name=frmCreate]")};n(".close-modal").on("click",function(){abp.libs.sweetAlert.config={confirm:{icon:"warning",buttons:["Không","Có"]}};abp.message.confirm(app.localize("Đóng"),app.localize("Bạn có chắc không"),function(n){if(n)return t.close(),!0})});this.save=function(){if(r.addClass("was-validated"),r[0].checkValidity()===!1){event.preventDefault();event.stopPropagation();return}var n=r.serializeFormToObject();console.log(n);t.setBusy(!0);u.create(n).done(function(i){t.close();u.get({id:i}).done(function(t){n.ItemId=t.id;n.ItemCode=t.itemCode;abp.notify.info("Thêm mới loại kho thành công!");abp.event.trigger("app.reloadDocTable")})}).always(function(){t.setBusy(!1)})}}}(jQuery),function(n){app.modals.EditItemsModal=function(){var u=abp.services.app.itemsService,t,r=null;this.init=function(u){for(n(".date-picker").datepicker({}),i=(new Date).getFullYear();i>1900;i--)n("#yearpicker").append(n("<option />").val(i).html(i));n("#Remark").summernote({height:270,forcus:!0});t=u;r=t.getModal().find("form[name=FrmEdit]");n("#CategoryCode").val(n(".CategoryCode").val());n("#GroupCode").val(n(".GroupCode").val());n("#KindCode").val(n(".KindCode").val());n("#ProducerCode").val(n(".ProducerCode").val());n("#SupplierCode").val(n(".SupplierCode").val());n("#Unit").val(n(".Unit").val());n("#yearpicker").val(n(".MFG").val())};n(".close-modal").on("click",function(){abp.libs.sweetAlert.config={confirm:{icon:"warning",buttons:["Không","Có"]}};abp.message.confirm(app.localize("Đóng"),app.localize("Bạn có chắc không"),function(n){if(n)return t.close(),!0})});this.save=function(){if(r.addClass("was-validated"),r[0].checkValidity()===!1){event.preventDefault();event.stopPropagation();return}var n=r.serializeFormToObject();console.log(n);t.setBusy(!0);u.update(n).done(function(){t.close();abp.notify.info("Cập nhật thành công!");abp.event.trigger("app.reloadDocTable")}).always(function(){t.setBusy(!1)})}}}(jQuery);