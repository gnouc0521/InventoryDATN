(function(n){app.modals.MyWorkEditModal=function(){var r=abp.services.app.purchaseAssignmentService,t,i;moment.locale(abp.localization.currentLanguage.name);i=null;this.init=function(n){t=n;i=t.getModal().find("form[name=frmCreate]")};n(".close-modal").on("click",function(){abp.libs.sweetAlert.config={confirm:{icon:"warning",buttons:["Không","Có"]}};abp.message.confirm(app.localize("Đóng"),app.localize("Bạn có chắc không"),function(n){if(n)return t.close(),!0})});this.save=function(){if(i.addClass("was-validated"),i[0].checkValidity()===!1){event.preventDefault();event.stopPropagation();return}var n=i.serializeFormToObject();t.setBusy(!0);r.update(n).done(function(){t.close();abp.notify.info("Cập nhật thành công!");abp.event.trigger("app.reloadDocTable")}).always(function(){t.setBusy(!1)})}}})(jQuery),function(){function e(){t.ajax.reload()}var i=$("#StaffTable"),o=abp.services.app.order,r=abp.services.app.ordersDetail,s=abp.services.app.purchaseAssignmentService,u=abp.services.app.userWorkCountService,n,f,t;moment.locale(abp.localization.currentLanguage.name);n=new app.ModalManager({viewUrl:abp.appPath+"Inventorys/MyWork/Sendmail",scriptUrl:abp.appPath+"view-resources/Areas/Oms/MyWork/Sendmail.js",modalClass:"SendMailModal",modalType:"modal-xl"});f=new app.ModalManager({viewUrl:abp.appPath+"Inventorys/MyWork/UpdateQuantity",scriptUrl:abp.appPath+"view-resources/Areas/Oms/MyWork/_EditQuantityModal.js",modalClass:"MyWorkEditModal",modalType:"modal-xl"});$("#SendmailNCC").click(function(){n.open()});t=i.DataTable({paging:!0,serverSide:!1,processing:!0,searching:!0,language:{emptyTable:"Không tìm thấy dữ liệu",lengthMenu:"Hiển thị _MENU_ bản ghi",zeroRecords:"Không tìm thấy dữ liệu",searchPlaceholder:"Tìm kiếm"},bInfo:!1,bLengthChange:!1,lengthMenu:[[5,10,25,50,-1],[5,10,25,50,"Tất cả"],],pageLength:5,listAction:{ajaxFunction:r.getItemMission},columnDefs:[{orderable:!1,targets:0,render:function(n,t,i,r){return r.row+1}},{orderable:!0,targets:1,data:"orderCode",render:function(n,t,i){return`<div class=''> 
                                <a class='doceditfunc' data-objid='`+i.id+`'href='javascript:void(0); ' > `+i.orderCode+` </a>
                            </div>`}},{orderable:!1,targets:2,data:"contractCode"},{orderable:!1,targets:3,data:"supplierName"},{orderable:!1,targets:4,data:"creationTime",render:function(n){return moment(n).format("L")}},{orderable:!1,targets:5,data:"note"},{orderable:!1,targets:6,data:"orderStatus",className:"align-middle text-center",render:function(n,t,i){return i.orderStatus==1?`<span class="span_status span-defaut"> Chưa xử lý </span>`:i.orderStatus==0?`<span class="span_status span-approve"> NCC Xác nhận </span>`:i.orderStatus==2?(i.userId=i.userId,i.workStatus=0,u.updateUserId(i),`<span class="span_status span-approve"> Đã hoàn thành </span>`):i.orderStatus==3?`<span class="span_status span-reject"> Sắp đến hạn </span>`:`<span class="span_status span-reject"> Qúa hạn </span>`}},]});$("#StaffTable").on("click",".doceditfunc",function(){var n=$(this),t={id:n[0].dataset.objid};abp.ajax({contentType:"application/x-www-form-urlencoded",url:abp.appPath+"Inventorys/Items/OverView?Id="+t.id,success:function(n){window.location.href="/Inventorys/MyWork/OrderDetail?id="+n.id}})});abp.event.on("app.reloadDocTable",function(){e()})}(jQuery),function(n){app.modals.SendMailModal=function(){var u=abp.services.app.purchaseAssignmentService,r=abp.services.app.supplier,i,t;moment.locale(abp.localization.currentLanguage.name);t=null;this.init=function(u){i=u;t=i.getModal().find("form[name=frmCreate]");n("#Comment").summernote({height:270});n("#SupplierId").on("change",function(){var t=function(){let t={};return t.supplierId=n("#SupplierId").find(":selected").val(),t};r.getSupplier(t()).done(function(t){n.each(t,function(t,i){n("#Address").val(i.adress);n("#PhoneNumber").val(i.phoneNumber);n("#TaxCode").val(i.taxCode);n("#EmailAddress").val(i.email)})})});n(".file-upload-field").bind("change",function(){n(this).parent().find(".custom-file-label").html(n(this).val().replace(/.*(\/|\\)/,""))});t.ajaxForm({beforeSubmit:function(){var u=t.find("input[name=file]"),n=u.get()[0].files,r;return n.length&&(r=n[0],r.size>10485760)?(abp.message.warn(app.localize("File_SizeLimit_Error")),i.setBusy(!1),!1):!0},success:function(n){n.success?(abp.notify.info("Gửi email thành công!"),i.close(),abp.event.trigger("app.reloadDocTable")):(abp.message.error(n.error.message),i.setBusy(!1))},error:function(n){abp.message.error(n.error.message)}})};n(".close-modal").on("click",function(){abp.libs.sweetAlert.config={confirm:{icon:"warning",buttons:["Không","Có"]}};abp.message.confirm(app.localize("Đóng"),app.localize("Bạn có chắc không"),function(n){if(n)return i.close(),!0})});this.save=function(){if(t.addClass("was-validated"),t[0].checkValidity()===!1){event.preventDefault();event.stopPropagation();return}var n=t.serializeFormToObject();t.submit()}}}(jQuery);