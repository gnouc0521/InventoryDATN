(function(){function f(){s.ajax.reload()}function e(){$(".btn-create").click(function(){var n=$(this).attr("data-create"),t={Id:n};u.open(t,function(n){console.log(n);c(n)})})}function t(){$(".btn-delete").click(function(){var t,i,r;console.log("lllllll");t=$(this).attr("data-delete");i=$(this).attr("data-parentId");i==0?abp.message.confirm(app.localize("Xóa Hồ sơ công việc"),app.localize("Bạn có chắc không"),i=>{i&&n.delete(t).done(n=>{$("#workGroup"+n).remove(),abp.notify.success(app.localize("Xóa Hồ sơ Công việc thành công"))})}):(r=$("#js_accordion-"+i).children(".accordion").length,r==1?abp.message.confirm(app.localize("Xóa Hồ sơ công việc"),app.localize("Bạn có chắc không"),r=>{r&&n.delete(t).done(n=>{$("#workGroup"+n).remove(),$("#workGroup"+i).children(".card").children(".card-header").children("a").children(".icon-actions").remove(),abp.notify.success(app.localize("Xóa Hồ sơ Công việc thành công"))})}):abp.message.confirm(app.localize("Xóa Hồ sơ công việc"),app.localize("Bạn có chắc không"),i=>{i&&n.delete(t).done(n=>{$("#workGroup"+n).remove(),abp.notify.success(app.localize("Xóa Hồ sơ Công việc thành công"))})}))})}function i(){$(".btn-edit").click(function(){var n=$(this).attr("data-edit"),t={Id:n};console.log($(this).parent("div").parent("div").children("a").children(".item_name").text("aaaaa"));console.log(n);o.open(t,function(n){console.log(n);$(".item_name"+n.Id).text(n.Title)})})}function y(){n.getAllListParent().done(function(n){var u="";$.each(n.items,function(n,t){var i=n+1;u=t.numItemsChild==0?`
                    <div class="accordion mt-2" id="workGroup`+t.id+`">
                        <div class="card">
                            <div class="card-header d-flex align-items-center">
                                <a href="javascript:void(0);" class="card-title text-title d-flex w-75" data-toggle="collapse" data-target="#js_accordion-`+t.id+`" aria-expanded="false">
                                   <span class="font-weight-bold text-index mr-1 indexing`+t.id+`">`+i+`.</span> 
                                    <span class="item_name`+t.id+`">`+t.title+`</span>
                                </a>
                                <div class="w-25 text-right mr-2">
                                    <button class='btn p-2 btn-create'  data-create='`+t.id+`' >
                                        <i class="far fa-plus-square fz-11"></i>
                                    </button>
                                    <button class='btn p-2 btn-edit'  data-edit='`+t.id+`' >
                                        <i class="fal fa-edit fz-11"></i>
                                    </button>
                                    <button class='btn p-2 btn-view'  data-view='`+t.id+`' >
                                        <i class="fal fa-eye fz-11"></i>
                                    </button>
                                    <button class='btn p-2 btn-delete'  data-delete='`+t.id+`' data-parentId='0'>
                                        <i class="fas fa-trash fz-11"></i>
                                    </button>
                                </div>
                            </div>
                            <div id="js_accordion-`+t.id+`" class="collapse pl-4" data-parent="#workGroup`+t.id+`">

                            </div>
                        </div>
                    </div>
                    `:`
                    <div class="accordion mt-2" id="workGroup`+t.id+`">
                        <div class="card">
                            <div class="card-header d-flex align-items-center">
                                <a href="javascript:void(0);" class="card-title text-title d-flex w-75" data-toggle="collapse" data-target="#js_accordion-`+t.id+`" aria-expanded="false">
                                    <span class="font-weight-bold text-index mr-1 indexing`+t.id+`">`+i+`.</span>
                                    <span class="item_name`+t.id+`">`+t.title+`</span>
                                        <span class="ml-3 pt-1 icon-actions">
                                            <span class="collapsed-reveal">
                                                <i class="fal fa-minus-circle text-danger fs-xl"></i>
                                            </span>
                                            <span class="collapsed-hidden">
                                                <i class="fal fa-plus-circle text-success fs-xl"></i>
                                            </span>
                                        </span>
                                </a>
                                <div class="w-25 text-right mr-2">
                                    <button class='btn p-2 btn-create'  data-create='`+t.id+`' >
                                        <i class="far fa-plus-square fz-11"></i>
                                    </button>
                                    <button class='btn p-2 btn-edit'  data-edit='`+t.id+`' >
                                        <i class="fal fa-edit fz-11"></i>
                                    </button>
                                      <button class='btn p-2 btn-view'  data-view='`+t.id+`' >
                                        <i class="fal fa-eye fz-11"></i>
                                    </button>
                                    <button class='btn p-2 btn-delete'  data-delete='`+t.id+`' data-parentId='0'>
                                        <i class="fas fa-trash fz-11"></i>
                                    </button>
                                </div>
                            </div>
                            <div id="js_accordion-`+t.id+`" class="collapse pl-4" data-parent="#workGroup`+t.id+`">

                            </div>
                        </div>
                    </div>
                    `;$("#tree_workProfile").append(u);h(t.id)});i();e();t();r()})}function h(f){var e="",o="";o=$(".indexing"+f).text();n.getAllListItem(f).done(function(n){n.items.length==0?e=null:($.each(n.items,function(n,t){var i=n+1;e=t.numItemsChild==0?`
                                <div class="accordion mt-2" id="workGroup`+t.id+`" class="mt-1">
                                    <div class="card">
                                        <div class="card-header d-flex align-items-center">
                                            <a href="javascript:void(0);" class="card-title text-title d-flex w-75" data-toggle="collapse" data-target="#js_accordion-`+t.id+`" aria-expanded="false">
                                                <span class="font-weight-bold text-index mr-1 indexing`+t.id+`">`+o+``+i+`.</span>
                                                <span class="item_name`+t.id+`">`+t.title+`</span>
                                            </a>
                                            <div class="w-25 text-right mr-2">
                                                <button class='btn p-2 btn-create`+t.id+`'  data-create='`+t.id+`' >
                                                    <i class="far fa-plus-square fz-11"></i>
                                                </button>
                                                <button class='btn p-2 btn-edit'  data-edit='`+t.id+`' >
                                                    <i class="fal fa-edit fz-11"></i>
                                                </button>
                                                 <button class='btn p-2 btn-view'  data-view='`+t.id+`' >
                                                      <i class="fal fa-eye fz-11"></i>
                                                 </button>
                                                <button class='btn p-2 btn-delete'  data-delete='`+t.id+`' data-parentId='`+f+`'>
                                                    <i class="fas fa-trash fz-11"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                        <div id="js_accordion-`+t.id+`" class="collapse pl-4" data-parent="#workGroup`+t.id+` ">
                                
                                        </div>
                                </div>
                            `:`
                                <div class="accordion mt-2" id="workGroup`+t.id+`" class="mt-1">
                                    <div class="card">
                                        <div class="card-header d-flex align-items-center">
                                            <a href="javascript:void(0);" class="card-title text-title d-flex w-75" data-toggle="collapse" data-target="#js_accordion-`+t.id+`" aria-expanded="false">
                                                <span class="font-weight-bold text-index mr-1 indexing`+t.id+`">`+o+``+i+`.</span>
                                                <span class="item_name`+t.id+`">`+t.title+`</span>
                                                <span class="ml-3 pt-1 icon-actions">
                                                    <span class="collapsed-reveal">
                                                        <i class="fal fa-minus-circle text-danger fs-xl"></i>
                                                    </span>
                                                    <span class="collapsed-hidden">
                                                        <i class="fal fa-plus-circle text-success fs-xl"></i>
                                                    </span>
                                                </span>
                                            </a>
                                            <div class="w-25 text-right mr-2">
                                                <button class='btn p-2 btn-create`+t.id+`'  data-create='`+t.id+`' >
                                                    <i class="far fa-plus-square fz-11"></i>
                                                </button>
                                                <button class='btn p-2 btn-edit'  data-edit='`+t.id+`' >
                                                    <i class="fal fa-edit fz-11"></i>
                                                </button>
                                                <button class='btn p-2 btn-view'  data-view='`+t.id+`' >
                                                    <i class="fal fa-eye fz-11"></i>
                                                 </button>
                                                <button class='btn p-2 btn-delete'  data-delete='`+t.id+`' >
                                                    <i class="fas fa-trash fz-11"></i>
                                                </button>
                                            </div>
                                            </div>
                                        </div>
                                        <div id="js_accordion-`+t.id+`" class="collapse pl-4" data-parent="#workGroup`+t.id+` ">
                                
                                        </div>
                                </div>
                            `;$("#js_accordion-"+f).append(e);h(t.id);$(".btn-create"+t.id).click(function(){console.log("âppsospdpdpd");var n=$(this).attr("data-create"),t={Id:n};u.open(t,function(n){console.log(n);c(n)})})}),i(),t(),r())})}function p(n){var u=$("#tree_workProfile").children(".accordion").length+1;html=`
                    <div class="accordion mt-2" id="workGroup`+n.Id+`">
                        <div class="card">
                            <div class="card-header d-flex align-items-center">
                                <a href="javascript:void(0);" class="card-title text-title d-flex w-75" data-toggle="collapse" data-target="#js_accordion-`+n.Id+`" aria-expanded="false">
                                   <span class="font-weight-bold text-index mr-1 indexing`+n.Id+`">`+u+`.</span>
                                   <span class="item_name`+n.Id+`">`+n.Title+`</span>
                                </a>
                                <div class="w-25 text-right mr-2">
                                    <button class='btn p-2 btn-create'  data-create='`+n.Id+`' >
                                        <i class="far fa-plus-square fz-11"></i>
                                    </button>
                                    <button class='btn p-2 btn-edit'  data-edit='`+n.Id+`' >
                                        <i class="fal fa-edit fz-11"></i>
                                    </button>
                                      <button class='btn p-2 btn-view'  data-view='`+n.Id+`' >
                                        <i class="fal fa-eye fz-11"></i>
                                    </button>
                                    <button class='btn p-2 btn-delete'  data-delete='`+n.Id+`' data-parentId='0'>
                                        <i class="fas fa-trash fz-11"></i>
                                    </button>
                                </div>
                            </div>
                            <div id="js_accordion-`+n.Id+`" class="collapse pl-4" data-parent="#workGroup`+n.Id+`">

                            </div>
                        </div>
                    </div>
                    `;$("#tree_workProfile").append(html);e();i();t();r()}function c(n){var o=$(".indexing"+n.ParentId).text(),s=$("#js_accordion-"+n.ParentId).children(".accordion").length+1,u,f;html=`
                    <div class="accordion mt-2" id="workGroup`+n.Id+`">
                        <div class="card">
                            <div class="card-header d-flex align-items-center">
                                <a href="javascript:void(0);" class="card-title text-title d-flex w-75" data-toggle="collapse" data-target="#js_accordion-`+n.Id+`" aria-expanded="false">
                                   <span class="font-weight-bold text-index mr-1 indexing`+n.Id+`">`+o+``+s+`.</span>
                                   <span class="item_name`+n.Id+`">`+n.Title+`</span>
                                </a>
                                <div class="w-25 text-right mr-2">
                                    <button class='btn p-2 btn-create'  data-create='`+n.Id+`' >
                                        <i class="far fa-plus-square fz-11"></i>
                                    </button>
                                    <button class='btn p-2 btn-edit'  data-edit='`+n.Id+`' >
                                        <i class="fal fa-edit fz-11"></i>
                                    </button>
                                     <button class='btn p-2 btn-view'  data-view='`+n.Id+`' >
                                        <i class="fal fa-eye fz-11"></i>
                                    </button>
                                    <button class='btn p-2 btn-delete'  data-delete='`+n.Id+`' data-parentId='`+n.ParentId+`'>
                                        <i class="fas fa-trash fz-11"></i>
                                    </button>
                                </div>
                            </div>
                            <div id="js_accordion-`+n.Id+`" class="collapse pl-4" data-parent="#workGroup`+n.Id+`">

                            </div>
                        </div>
                    </div>
                    `;u=$("#js_accordion-"+n.ParentId).children(".accordion").length;u==0?(f=`
                                <span class="ml-3 pt-1 icon-actions">
                                    <span class="collapsed-reveal">
                                        <i class="fal fa-minus-circle text-danger fs-xl"></i>
                                    </span>
                                    <span class="collapsed-hidden">
                                        <i class="fal fa-plus-circle text-success fs-xl"></i>
                                    </span>
                                </span>
                                `,$("#workGroup"+n.ParentId).children(".card").children(".card-header").children("a").append(f),$("#js_accordion-"+n.ParentId).append(html)):$("#js_accordion-"+n.ParentId).append(html);e();i();t();r()}function r(){$(".btn-view").click(function(){var t=$(this).attr("data-view"),n={Id:t};console.log("11",n);abp.ajax({contentType:"application/x-www-form-urlencoded",url:"ProfileWork/View/?Id="+n.Id,success:function(n){window.location.href="/PersonalProfile/ProfileWork/ViewDetails?id="+n.id}})})}var l=$("#profileWorkTable"),n=abp.services.app.profileWork,s;moment.locale(abp.localization.currentLanguage.name);var a=new app.ModalManager({viewUrl:abp.appPath+"PersonalProfile/ProfileWork/CreateProfileWork",scriptUrl:abp.appPath+"view-resources/Areas/Oms/ProfileWorks/_CreateModal.js",modalClass:"CreatDelModal",modalType:"modal-xl"}),u=new app.ModalManager({viewUrl:abp.appPath+"PersonalProfile/ProfileWork/CreateProfileWorkItems",scriptUrl:abp.appPath+"view-resources/Areas/Oms/ProfileWorks/_CreateWorkItemModal.js",modalClass:"WorkitemCreateModal",modalType:"modal-xl"}),o=new app.ModalManager({viewUrl:abp.appPath+"PersonalProfile/ProfileWork/EditProfileWork",scriptUrl:abp.appPath+"view-resources/Areas/Oms/ProfileWorks/_EditModal.js",modalClass:"DeliveryEditModal",modalType:"modal-xl"}),v=function(){let n={},t=document.getElementById("list-workgroup");return n.idProfileWork=t.options[t.selectedIndex].value,n.searchTerm=$("#SearchTerm").val(),n};$("#list-workgroup").change(function(){f()});s=l.DataTable({paging:!0,serverSide:!0,processing:!0,searching:!1,language:{info:"Hiển thị _START_ đến _END_ của _TOTAL_ kết quả tìm thấy",infoEmpty:"",emptyTable:"Không tìm thấy dữ liệu"},bLengthChange:!1,pageLength:10,listAction:{ajaxFunction:n.getAll,inputFilter:v},columnDefs:[{targets:0,data:null,orderable:!1,autoWidth:!1,render:function(n,t,i){return i.parentId==null?`                        
                            <div class='dropdown d-inline-block'>
                            	<a href='#'' class='btn btn-sm btn-icon btn-outline-primary rounded-circle shadow-0' data-toggle='dropdown' aria-expanded='true' title='More options'>
                            		<i class="fal fa-ellipsis-v"></i>
                            	</a>
                            	<div class='dropdown-menu'>
                                    <a class='dropdown-item docaddwork'  data-objid='`+i.id+`' href='javascript:void(0);'> Thêm mới nhóm công việc</a>
                                    <a class='dropdown-item docviewdt' data-objid='`+i.id+`'href='javascript:void(0); ' > Xem chi tiết</a>
                            		<a class='dropdown-item doceditfunc'data-objid='`+i.id+`'href='javascript:void(0); ' > Sửa </a>
                                    <a class='dropdown-item docdeletefunc'  data-objid='`+i.id+`' href='javascript:void(0);'> Xóa </a>
                            	</div>
                            </div>`:`                        
                            <div class='dropdown d-inline-block'>
                            	<a href='#'' class='btn btn-sm btn-icon btn-outline-primary rounded-circle shadow-0' data-toggle='dropdown' aria-expanded='true' title='More options'>
                            		<i class="fal fa-ellipsis-v"></i>
                            	</a>
                            	<div class='dropdown-menu'>
                                    <a class='dropdown-item docviewdt' data-objid='`+i.id+`'href='javascript:void(0); ' > Xem chi tiết</a>
                            		<a class='dropdown-item doceditfunc'data-objid='`+i.id+`'href='javascript:void(0); ' > Sửa </a>
                                    <a class='dropdown-item docdeletefunc'  data-objid='`+i.id+`' href='javascript:void(0);'> Xóa </a>
                            	</div>
                            </div>`}},{orderable:!1,targets:1,data:"title"},]});abp.event.on("app.reloadDocTable",function(){f()});$("#profileWorkTable").on("click",".doceditfunc",function(){var n=$(this),t={id:n[0].dataset.objid};o.open(t)});$("#profileWorkTable").on("click",".docaddwork",function(){var t=$(this),n={Id:t[0].dataset.objid};console.log("aaa",n);u.open(n)});$("#profileWorkTable").on("click",".docviewdt",function(){var n=$(this),t={id:n[0].dataset.objid};abp.ajax({contentType:"application/x-www-form-urlencoded",url:"ProfileWork/View/?Id="+t.id,success:function(n){window.location.href="/PersonalProfile/ProfileWork/ViewDetails?id="+n.id}})});$("#Search").click(function(n){n.preventDefault();f()});jQuery(document).ready(function(){$("#SearchTerm").focus()});y();$("#CreateNewButtonxx").click(function(){console.log("ádsa");a.open(1,function(n){p(n)})})})(jQuery),function(n){app.modals.CreatDelModal=function(){var r=abp.services.app.profileWork,t,i=null;this.init=function(n){t=n;i=t.getModal().find("form[name=frmCreate]")};n(".close-modal").on("click",function(){abp.libs.sweetAlert.config={confirm:{icon:"warning",buttons:["Không","Có"]}};abp.message.confirm(app.localize("Đóng"),app.localize("Bạn có chắc không"),function(n){if(n)return t.close(),!0})});this.save=function(){if(i.addClass("was-validated"),i[0].checkValidity()===!1){event.preventDefault();event.stopPropagation();return}var n=i.serializeFormToObject();n.ParentId=null;n.Order=10;n.WorkProfileLevel=1;t.setBusy(!0);r.create(n).done(function(i){t.close();abp.notify.info("Thêm mới thành công!");n.Id=i;t.setResult(n)}).always(function(){t.setBusy(!1)})}}}(jQuery),function(){app.modals.DeliveryEditModal=function(){var i=abp.services.app.profileWork,n,t=null;this.init=function(i){n=i;t=n.getModal().find("form[name=FrmEdit]")};this.save=function(){if(t.addClass("was-validated"),t[0].checkValidity()===!1){event.preventDefault();event.stopPropagation();return}var r=t.serializeFormToObject();n.setBusy(!0);i.update(r).done(function(){n.close();abp.notify.info("Cập nhật thành công!");n.setResult(r)}).always(function(){n.setBusy(!1)})}}}(jQuery),function(){function f(){u.ajax.reload()}var i=$("#TableViewWork"),e=$("#TableViewFile"),n=abp.services.app.profileWork;moment.locale(abp.localization.currentLanguage.name);var r=new app.ModalManager({viewUrl:abp.appPath+"PersonalProfile/Work/ViewDetails",scriptUrl:abp.appPath+"view-resources/Areas/Oms/Works/_uploadFile.js",modalClass:"ViewModal",modalType:"modal-xl"}),t=function(){let n={},t=$("#ProfileWorkId").val();return n.idProfileWork=t,n.searchTerm=$("#SearchTerm").val().toLocaleLowerCase(),n},u=i.DataTable({paging:!0,serverSide:!1,processing:!0,searching:!1,language:{emptyTable:"Không tìm thấy dữ liệu",lengthMenu:"Hiển thị _MENU_ bản ghi"},bInfo:!1,bLengthChange:!0,lengthMenu:[[5,10,25,50,-1],[5,10,25,50,"Tất cả"],],pageLength:10,listAction:{ajaxFunction:n.getAllWorkByProfileWorkId,inputFilter:t},columnDefs:[{orderable:!1,targets:0,className:"text-center",render:function(n,t,i,r){var u=r.row+1;return`<span>`+u+`</span>`}},{orderable:!1,targets:1,render:function(n,t,i){return`
                        <a class="viewwork" data-objid='`+i.id+`' href='javascript:void(0); '>`+i.title+`</a>
                    `}},{orderable:!1,targets:2,data:"hostName"},{orderable:!1,targets:3,data:"startDate",render:function(n){return moment(n).format("L")}},{orderable:!1,targets:4,data:"endDate",render:function(n){return moment(n).format("L")}},{orderable:!1,targets:5,data:"fileNum"},]});$("#TableViewWork").on("click",".viewwork",function(){var n=$(this),t={id:n[0].dataset.objid};r.open(t)});$("#Search").click(function(n){n.preventDefault();f()});n.getAllWorkByProfileWorkIdInChart(t()).done(function(n){for(var i=0,f=0,e=0,o=0,s=0,r=0,h=0,c=0,l=0,a=0,u=0,v=0,y=0,p=0,w=0,t=0;t<n.items.length;t++)n.items[t].ownerStatusEnum==1?(n.items[t].status==2&&(f+=1,i+=1),n.items[t].status==1&&(e+=1,i+=1),n.items[t].status==3&&(s+=1,i+=1),n.items[t].status==0&&(o+=1,i+=1)):n.items[t].ownerStatusEnum==4?(n.items[t].status==2&&(h+=1,r+=1),n.items[t].status==1&&(c+=1,r+=1),n.items[t].status==3&&(a+=1,r+=1),n.items[t].status==0&&(l+=1,r+=1)):n.items[t].ownerStatusEnum==2&&(n.items[t].status==2&&(v+=1,u+=1),n.items[t].status==1&&(y+=1,u+=1),n.items[t].status==3&&(w+=1,u+=1),n.items[t].status==0&&(p+=1,u+=1));$("#sum-dg_ht").html(f);$("#sum-dg_dag").html(e);$("#sum-dg_ch").html(o);$("#sum-dg_qh").html(s);$(".sum-dg_all").html(i);$("#sum-dag_ht").html(h);$("#sum-dag_dag").html(c);$("#sum-dag_ch").html(l);$("#sum-dag_qh").html(a);$(".sum-dag_all").html(r);$("#sum-ph_ht").html(v);$("#sum-ph_dag").html(y);$("#sum-ph_ch").html(p);$("#sum-ph_qh").html(w);$(".sum-ph_all").html(u)})}(jQuery);