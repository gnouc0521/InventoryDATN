(function(){function t(){n.ajax.reload()}var u=$("#subsidiaryTable"),i=abp.services.app.subsidiaryService,r,n;moment.locale(abp.localization.currentLanguage.name);var f=new app.ModalManager({viewUrl:abp.appPath+"Inventorys/Subsidiary/Create",scriptUrl:abp.appPath+"view-resources/Areas/Oms/Subsidiaries/_CreateModal.js",modalClass:"SubsidiaryCreateModal",modalType:"modal-xl"}),e=new app.ModalManager({viewUrl:abp.appPath+"Inventorys/Subsidiary/Update",scriptUrl:abp.appPath+"view-resources/Areas/Oms/Subsidiaries/_EditModal.js",modalClass:"SubsidiaryEditModal",modalType:"modal-xl"}),o=new app.ModalManager({viewUrl:abp.appPath+"Inventorys/Subsidiary/ViewDetails",scriptUrl:abp.appPath+"view-resources/Areas/Oms/Subsidiaries/ViewDetail.js",modalClass:"ViewModal",modalType:"modal-xl"});$("#CreateNewButtonxx").click(function(){f.open()});r=function(){let n={};return n.searchTerm=$("#SearchTerm").val(),n};n=u.DataTable({paging:!0,serverSide:!1,processing:!0,searching:!1,language:{emptyTable:"Không tìm thấy dữ liệu",lengthMenu:"Hiển thị _MENU_ bản ghi"},bInfo:!1,bLengthChange:!0,lengthMenu:[[5,10,25,50,-1],[5,10,25,50,"Tất cả"],],pageLength:10,listAction:{ajaxFunction:i.getAll,inputFilter:r},order:[[1,"asc"]],columnDefs:[{targets:0,orderable:!1,className:"dt-body-center text-center",render:function(n,t,i){return'<input type="checkbox" name="" data-value="'+i.id+'">'}},{orderable:!1,targets:1,data:"nameCompany",render:function(n,t,i){return console.log(i),`
                        <a class="viewproducer" data-viewid='`+i.id+`' href='javascript:void(0); '>`+i.nameCompany+`</a>
                    `}},{orderable:!1,targets:2,data:"address"},{orderable:!0,targets:3,data:"phoneNumber"},{orderable:!0,targets:4,data:"emailAddress"},{targets:5,data:null,orderable:!1,autoWidth:!1,className:"text-center",render:function(n,t,i){return` <a class='btn btn-warning doceditfunc text-white' data-objid='`+i.id+`'href='javascript:void(0); ' > Sửa </a>`}}]});abp.event.on("app.reloadDocTable",function(){t()});$("#example-select-all").on("click",function(){var i=n.rows({search:"applied"}).nodes(),t;$('input[type="checkbox"]',i).prop("checked",this.checked);$("#DeleteAll").removeAttr("disabled");t=[];$('#subsidiaryTable tbody input[type="checkbox"]:checked').each(function(){t.push($(this))});t.length>0?$("#DeleteAll").removeAttr("disabled"):$("#DeleteAll").prop("disabled",!0)});$("#subsidiaryTable tbody").on("change",'input[type="checkbox"]',function(){var t=[],n;$('#subsidiaryTable tbody input[type="checkbox"]:checked').each(function(){t.push($(this))});t.length>0?$("#DeleteAll").removeAttr("disabled"):$("#DeleteAll").prop("disabled",!0);this.checked||(n=$("#example-select-all").get(0),n&&n.checked&&"indeterminate"in n&&(n.indeterminate=!0))});n.$('input[type="checkbox"]').each(function(n,t){t>0&&$("#DeleteAll").removeAttr("disabled")});$("#DeleteAll").on("click",function(){abp.message.confirm(app.localize("Xóa công ty"),app.localize("Bạn có chắc không"),function(r){r&&n.$('input[type="checkbox"]').each(function(n,r){$(r).is(":checked")&&(console.log("valưe",$(r).attr("data-value")),i.delete($(r).attr("data-value")).done(function(){$("#example-select-all").prop("checked",!1);abp.notify.success(app.localize("Xóa công ty thành công"));t()}))})})});$("#subsidiaryTable").on("click",".doceditfunc",function(){var n=$(this),t={id:n[0].dataset.objid};e.open(t)});$("#subsidiaryTable").on("click",".viewproducer",function(){var n=$(this),t={id:n[0].dataset.viewid};abp.ajax({contentType:"application/x-www-form-urlencoded",url:abp.appPath+"Inventorys/Subsidiary/OverView?Id="+t.id,success:function(n){window.location.href="/Inventorys/Subsidiary/ViewDetails?id="+n.id}})});$("#Search").click(function(n){n.preventDefault();t()});jQuery(document).ready(function(){$("#SearchTerm").focus()})})(jQuery),function(n){app.modals.SubsidiaryCreateModal=function(){var r=abp.services.app.subsidiaryService,i,t=null;this.init=function(u){function h(t,i,u,f){var e=n(u).attr("data-select-id");o(u,f,!1);r.getAddress(t,i).done(t=>{for(let i=0;i<t.addresses.length;i++)n(u).append(`<option value="${t.addresses[i].id}" data-id="${t.addresses[i].id}"
                                                   ${e==t.addresses[i].name?"selected":""} >
                                                    ${t.addresses[i].name}
                                    </option>`)})}function o(t,i,r){n(t).empty();n(t).prop("disabled",r);n(t).append(`<option value="" selected disabled>`+i+`</option>`)}function a(){var n=t.find("input[name=PhoneNumber]").val();return n.substring(0,1)==0?t.find("input[name=PhoneNumber]").val().replace("0",""):t.find("input[name=PhoneNumber]").val().replace(/[^0-9]/g,"")}i=u;t=i.getModal().find("form[name=frmCreate]");var s="#selectProvinceOfBirth",f="#selectDistrictOfBirth",e="#selectVillageOfBirth",c="district.json",l="village.json";n(document).on("change",s,function(){o(e,"Chọn Xã/Phường",!0);h(c,n(s).find(":selected").attr("data-id"),f,"Chọn Huyện/Quận")});n(document).on("change",f,function(){o(e,"Chọn Xã/Phường",!1);h(l,n(f).find(":selected").attr("data-id"),e,"Chọn Xã/Phường")});document.getElementById("PhoneNumber").addEventListener("input",function(){var n=a();t.find("input[name=PhoneNumber]").val(n)})};n(".cancel-work-button").click(function(){abp.libs.sweetAlert.config={confirm:{icon:"warning",buttons:["Không","Có"]}};abp.message.confirm(app.localize("Đóng"),app.localize("Bạn có chắc không"),function(n){if(n)return i.close(),!0})});this.save=function(){if(t.addClass("was-validated"),t[0].checkValidity()===!1){event.preventDefault();event.stopPropagation();return}var n=t.serializeFormToObject();i.setBusy(!0);r.create(n).done(function(){i.close();abp.notify.info("Thêm mới thành công!");abp.event.trigger("app.reloadDocTable")}).always(function(){i.setBusy(!1)})}}}(jQuery),function(n){app.modals.SubsidiaryEditModal=function(){var r=abp.services.app.subsidiaryService,i,t=null;this.init=function(u){function l(t,i,u,f){var e=n(u).attr("data-select-id");s(u,f,!1);r.getAddress(t,i).done(t=>{for(let i=0;i<t.addresses.length;i++)n(u).append(`<option value="${t.addresses[i].id}" data-id="${t.addresses[i].id}"
                                                   ${e==t.addresses[i].name?"selected":""} >
                                                    ${t.addresses[i].name}
                                    </option>`)})}function s(t,i,r){n(t).empty();n(t).prop("disabled",r);n(t).append(`<option value="" selected disabled>`+i+`</option>`)}function a(){var n=t.find("input[name=PhoneNumber]").val();return n.substring(0,1)==0?t.find("input[name=PhoneNumber]").val().replace("0",""):t.find("input[name=PhoneNumber]").val().replace(/[^0-9]/g,"")}i=u;t=i.getModal().find("form[name=FrmEdit]");var o="#selectProvinceOfBirth",f="#selectDistrictOfBirth",e="#selectVillageOfBirth",h="district.json",c="village.json";n(o).val(n("#valueCityId").val());r.getAddress(h,n("#valueCityId").val()).done(t=>{for(let i=0;i<t.addresses.length;i++)n(f).append(`<option value="${t.addresses[i].id}" data-id="${t.addresses[i].id}"
                                                    >
                                                    ${t.addresses[i].name}
                                    </option>`);n(f).val(n("#valueDistrictId").val())});r.getAddress(c,n("#valueDistrictId").val()).done(t=>{console.log(t);for(let i=0;i<t.addresses.length;i++)n(e).append(`<option value="${t.addresses[i].id}" data-id="${t.addresses[i].id}"
                                                    >
                                                    ${t.addresses[i].name}
                                    </option>`);console.log("sfasdf");n(e).val(n("#valueWardsId").val())});n(document).on("change",o,function(){s(e,"Chọn Xã/Phường",!0);l(h,n(o).find(":selected").attr("data-id"),f,"Chọn Huyện/Quận")});n(document).on("change",f,function(){s(e,"Chọn Xã/Phường",!1);l(c,n(f).find(":selected").attr("data-id"),e,"Chọn Xã/Phường")});document.getElementById("PhoneNumber").addEventListener("input",function(){var n=a();t.find("input[name=PhoneNumber]").val(n)})};n(".cancel-work-button").click(function(){abp.libs.sweetAlert.config={confirm:{icon:"warning",buttons:["Không","Có"]}};abp.message.confirm(app.localize("Đóng Nhà cung cấp"),app.localize("Bạn có chắc không"),function(n){if(n)return i.close(),!0})});this.save=function(){if(t.addClass("was-validated"),t[0].checkValidity()===!1){event.preventDefault();event.stopPropagation();return}var n=t.serializeFormToObject();i.setBusy(!0);r.update(n).done(function(){i.close();abp.notify.info("Sửa thành công!");abp.event.trigger("app.reloadDocTable")}).always(function(){i.setBusy(!1)})}}}(jQuery),function(){function n(n,i,r,u){t.getAddress(n,i).done(n=>{for(let t=0;t<n.addresses.length;t++)n.addresses[t].id==r&&$(u).html(n.addresses[t].name)})}var t=abp.services.app.subsidiaryService;moment.locale(abp.localization.currentLanguage.name);fullPathProvince="province.json";fullPathDistrict="district.json";fullPathVillage="village.json";n(fullPathProvince,"",$("#CityId").val(),"#CityName");n(fullPathDistrict,$("#CityId").val(),$("#DistrictId").val(),"#DistrictName");n(fullPathVillage,$("#DistrictId").val(),$("#WardsId").val(),"#VillageName")}(jQuery);