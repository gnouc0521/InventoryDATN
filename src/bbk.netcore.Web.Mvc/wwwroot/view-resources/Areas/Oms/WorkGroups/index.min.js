(function(){function u(){o.ajax.reload()}function f(){$(".btn-create").click(function(){console.log("âppsospdpdpd");var n=$(this).attr("data-create"),t={Id:n};r.open(t,function(n){console.log(n);h(n)})})}function t(){$(".btn-delete").click(function(){var t=$(this).attr("data-delete"),i=$(this).attr("data-parentId"),r;i==0?abp.message.confirm(app.localize("Xóa Nhóm công việc"),app.localize("Bạn có chắc không"),i=>{i&&n.delete(t).done(n=>{$("#workGroup"+n).remove(),abp.notify.success(app.localize("Xóa Nhóm Công việc thành công"))})}):(r=$("#js_accordion-"+i).children(".accordion").length,r==1?abp.message.confirm(app.localize("Xóa Nhóm công việc"),app.localize("Bạn có chắc không"),r=>{r&&n.delete(t).done(n=>{$("#workGroup"+n).remove(),$("#workGroup"+i).children(".card").children(".card-header").children("a").children(".icon-actions").remove(),abp.notify.success(app.localize("Xóa Nhóm Công việc thành công"))})}):abp.message.confirm(app.localize("Xóa Nhóm công việc"),app.localize("Bạn có chắc không"),i=>{i&&n.delete(t).done(n=>{$("#workGroup"+n).remove(),abp.notify.success(app.localize("Xóa Nhóm Công việc thành công"))})}))})}function i(){$(".btn-edit").click(function(){var n=$(this).attr("data-edit"),t={Id:n};console.log($(this).parent("div").parent("div").children("a").children(".item_name").text("aaaaa"));console.log(n);e.open(t,function(n){console.log(n);$(".item_name"+n.Id).text(n.Title)})})}function v(){n.getAllListParent().done(function(n){var r="";$.each(n.items,function(n,t){var i=n+1;r=t.numItemsChild==0?`
                    <div class="accordion mt-2" id="workGroup`+t.id+`">
                        <div class="card">
                            <div class="card-header d-flex align-items-center">
                                <a href="javascript:void(0);" class="card-title text-title d-flex w-75" data-toggle="collapse" data-target="#js_accordion-`+t.id+`" aria-expanded="false">
                                   <span class="font-weight-bold text-index mr-1 indexing`+t.id+`">`+i+`.</span> 
                                    <span class="item_name`+t.id+`">`+t.title+`</span>
                                </a>
                                <div class="w-25 text-right mr-2">
                                    <button class='btn p-2 btn-create'  data-create='`+t.id+`' >
                                        <i class="far fa-plus-square fz-11"></i>
                                    </button>
                                    <button class='btn p-2 btn-edit'  data-edit='`+t.id+`' >
                                        <i class="fal fa-edit fz-11"></i>
                                    </button>
                                    <button class='btn p-2 btn-delete'  data-delete='`+t.id+`' data-parentId='0'>
                                        <i class="fas fa-trash fz-11"></i>
                                    </button>
                                </div>
                            </div>
                            <div id="js_accordion-`+t.id+`" class="collapse pl-4" data-parent="#workGroup`+t.id+`">

                            </div>
                        </div>
                    </div>
                    `:`
                    <div class="accordion mt-2" id="workGroup`+t.id+`">
                        <div class="card">
                            <div class="card-header d-flex align-items-center">
                                <a href="javascript:void(0);" class="card-title text-title d-flex w-75" data-toggle="collapse" data-target="#js_accordion-`+t.id+`" aria-expanded="false">
                                    <span class="font-weight-bold text-index mr-1 indexing`+t.id+`">`+i+`.</span>
                                    <span class="item_name`+t.id+`">`+t.title+`</span>
                                        <span class="ml-3 pt-1 icon-actions">
                                            <span class="collapsed-reveal">
                                                <i class="fal fa-minus-circle text-danger fs-xl"></i>
                                            </span>
                                            <span class="collapsed-hidden">
                                                <i class="fal fa-plus-circle text-success fs-xl"></i>
                                            </span>
                                        </span>
                                </a>
                                <div class="w-25 text-right mr-2">
                                    <button class='btn p-2 btn-create'  data-create='`+t.id+`' >
                                        <i class="far fa-plus-square fz-11"></i>
                                    </button>
                                    <button class='btn p-2 btn-edit'  data-edit='`+t.id+`' >
                                        <i class="fal fa-edit fz-11"></i>
                                    </button>
                                    <button class='btn p-2 btn-delete'  data-delete='`+t.id+`' data-parentId='0'>
                                        <i class="fas fa-trash fz-11"></i>
                                    </button>
                                </div>
                            </div>
                            <div id="js_accordion-`+t.id+`" class="collapse pl-4" data-parent="#workGroup`+t.id+`">

                            </div>
                        </div>
                    </div>
                    `;$("#tree_workGroup").append(r);s(t.id)});i();f();t()})}function s(u){var f="",e="";e=$(".indexing"+u).text();n.getAllListItem(u).done(function(n){n.items.length==0?f=null:($.each(n.items,function(n,t){var i=n+1;f=t.numItemsChild==0?`
                                <div class="accordion mt-2" id="workGroup`+t.id+`" class="mt-1">
                                    <div class="card">
                                        <div class="card-header d-flex align-items-center">
                                            <a href="javascript:void(0);" class="card-title text-title d-flex w-75" data-toggle="collapse" data-target="#js_accordion-`+t.id+`" aria-expanded="false">
                                                <span class="font-weight-bold text-index mr-1 indexing`+t.id+`">`+e+``+i+`.</span>
                                                <span class="item_name`+t.id+`">`+t.title+`</span>
                                            </a>
                                            <div class="w-25 text-right mr-2">
                                                <button class='btn p-2 btn-create`+t.id+`'  data-create='`+t.id+`' >
                                                    <i class="far fa-plus-square fz-11"></i>
                                                </button>
                                                <button class='btn p-2 btn-edit'  data-edit='`+t.id+`' >
                                                    <i class="fal fa-edit fz-11"></i>
                                                </button>
                                                <button class='btn p-2 btn-delete'  data-delete='`+t.id+`' data-parentId='`+u+`'>
                                                    <i class="fas fa-trash fz-11"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                        <div id="js_accordion-`+t.id+`" class="collapse pl-4" data-parent="#workGroup`+t.id+` ">
                                
                                        </div>
                                </div>
                            `:`
                                <div class="accordion mt-2" id="workGroup`+t.id+`" class="mt-1">
                                    <div class="card">
                                        <div class="card-header d-flex align-items-center">
                                            <a href="javascript:void(0);" class="card-title text-title d-flex w-75" data-toggle="collapse" data-target="#js_accordion-`+t.id+`" aria-expanded="false">
                                                <span class="font-weight-bold text-index mr-1 indexing`+t.id+`">`+e+``+i+`.</span>
                                                <span class="item_name`+t.id+`">`+t.title+`</span>
                                                <span class="ml-3 pt-1 icon-actions">
                                                    <span class="collapsed-reveal">
                                                        <i class="fal fa-minus-circle text-danger fs-xl"></i>
                                                    </span>
                                                    <span class="collapsed-hidden">
                                                        <i class="fal fa-plus-circle text-success fs-xl"></i>
                                                    </span>
                                                </span>
                                            </a>
                                            <div class="w-25 text-right mr-2">
                                                <button class='btn p-2 btn-create`+t.id+`'  data-create='`+t.id+`' >
                                                    <i class="far fa-plus-square fz-11"></i>
                                                </button>
                                                <button class='btn p-2 btn-edit'  data-edit='`+t.id+`' >
                                                    <i class="fal fa-edit fz-11"></i>
                                                </button>
                                                <button class='btn p-2 btn-delete'  data-delete='`+t.id+`' >
                                                    <i class="fas fa-trash fz-11"></i>
                                                </button>
                                            </div>
                                            </div>
                                        </div>
                                        <div id="js_accordion-`+t.id+`" class="collapse pl-4" data-parent="#workGroup`+t.id+` ">
                                
                                        </div>
                                </div>
                            `;$("#js_accordion-"+u).append(f);s(t.id);$(".btn-create"+t.id).click(function(){console.log("âppsospdpdpd");var n=$(this).attr("data-create"),t={Id:n};r.open(t,function(n){console.log(n);h(n)})})}),i(),t())})}function y(n){var r=$("#tree_workGroup").children(".accordion").length+1;html=`
                    <div class="accordion mt-2" id="workGroup`+n.Id+`">
                        <div class="card">
                            <div class="card-header d-flex align-items-center">
                                <a href="javascript:void(0);" class="card-title text-title d-flex w-75" data-toggle="collapse" data-target="#js_accordion-`+n.Id+`" aria-expanded="false">
                                   <span class="font-weight-bold text-index mr-1 indexing`+n.Id+`">`+r+`.</span>
                                   <span class="item_name`+n.Id+`">`+n.Title+`</span>
                                </a>
                                <div class="w-25 text-right mr-2">
                                    <button class='btn p-2 btn-create'  data-create='`+n.Id+`' >
                                        <i class="far fa-plus-square fz-11"></i>
                                    </button>
                                    <button class='btn p-2 btn-edit'  data-edit='`+n.Id+`' >
                                        <i class="fal fa-edit fz-11"></i>
                                    </button>
                                    <button class='btn p-2 btn-delete'  data-delete='`+n.Id+`' data-parentId='0'>
                                        <i class="fas fa-trash fz-11"></i>
                                    </button>
                                </div>
                            </div>
                            <div id="js_accordion-`+n.Id+`" class="collapse pl-4" data-parent="#workGroup`+n.Id+`">

                            </div>
                        </div>
                    </div>
                    `;$("#tree_workGroup").append(html);f();i();t()}function h(n){var e=$(".indexing"+n.ParentId).text(),o=$("#js_accordion-"+n.ParentId).children(".accordion").length+1,r,u;html=`
                    <div class="accordion mt-2" id="workGroup`+n.Id+`">
                        <div class="card">
                            <div class="card-header d-flex align-items-center">
                                <a href="javascript:void(0);" class="card-title text-title d-flex w-75" data-toggle="collapse" data-target="#js_accordion-`+n.Id+`" aria-expanded="false">
                                   <span class="font-weight-bold text-index mr-1 indexing`+n.Id+`">`+e+``+o+`.</span>
                                   <span class="item_name`+n.Id+`">`+n.Title+`</span>
                                </a>
                                <div class="w-25 text-right mr-2">
                                    <button class='btn p-2 btn-create'  data-create='`+n.Id+`' >
                                        <i class="far fa-plus-square fz-11"></i>
                                    </button>
                                    <button class='btn p-2 btn-edit'  data-edit='`+n.Id+`' >
                                        <i class="fal fa-edit fz-11"></i>
                                    </button>
                                    <button class='btn p-2 btn-delete'  data-delete='`+n.Id+`' data-parentId='`+n.ParentId+`'>
                                        <i class="fas fa-trash fz-11"></i>
                                    </button>
                                </div>
                            </div>
                            <div id="js_accordion-`+n.Id+`" class="collapse pl-4" data-parent="#workGroup`+n.Id+`">

                            </div>
                        </div>
                    </div>
                    `;r=$("#js_accordion-"+n.ParentId).children(".accordion").length;r==0?(u=`
                                <span class="ml-3 pt-1 icon-actions">
                                    <span class="collapsed-reveal">
                                        <i class="fal fa-minus-circle text-danger fs-xl"></i>
                                    </span>
                                    <span class="collapsed-hidden">
                                        <i class="fal fa-plus-circle text-success fs-xl"></i>
                                    </span>
                                </span>
                                `,$("#workGroup"+n.ParentId).children(".card").children(".card-header").children("a").append(u),$("#js_accordion-"+n.ParentId).append(html)):$("#js_accordion-"+n.ParentId).append(html);f();i();t()}var c=$("#workGroupTable"),n=abp.services.app.workGroup,o;moment.locale(abp.localization.currentLanguage.name);var l=new app.ModalManager({viewUrl:abp.appPath+"PersonalProfile/WorkGroup/CreateWorkRoot",scriptUrl:abp.appPath+"view-resources/Areas/Oms/WorkGroups/_CreateWorkRootModal.js",modalClass:"WorkRootCreateModal",modalType:"modal-xl"}),r=new app.ModalManager({viewUrl:abp.appPath+"PersonalProfile/WorkGroup/CreateWorkItems",scriptUrl:abp.appPath+"view-resources/Areas/Oms/WorkGroups/_CreateWorkItemModal.js",modalClass:"WorkitemCreateModal",modalType:"modal-xl"}),e=new app.ModalManager({viewUrl:abp.appPath+"PersonalProfile/WorkGroup/EditWorkGroup",scriptUrl:abp.appPath+"view-resources/Areas/Oms/WorkGroups/_EditModal.js",modalClass:"WorkGroupEditModal",modalType:"modal-xl"}),a=function(){let n={},t=document.getElementById("list-workgroup");return n.idWorkGroup=t.options[t.selectedIndex].value,n.searchTerm=$("#SearchTerm").val(),n};$("#list-workgroup").change(function(){u()});o=c.DataTable({paging:!0,serverSide:!0,processing:!0,searching:!1,language:{info:"Hiển thị _START_ đến _END_ của _TOTAL_ kết quả tìm thấy",infoEmpty:"",emptyTable:"Không tìm thấy dữ liệu"},bLengthChange:!1,pageLength:10,listAction:{ajaxFunction:n.getAll,inputFilter:a},columnDefs:[{targets:0,data:null,orderable:!1,autoWidth:!1,render:function(n,t,i){return i.parentId==null?`                        
                            <div class='dropdown d-inline-block'>
                            	<a href='#'' class='btn btn-sm btn-icon btn-outline-primary rounded-circle shadow-0' data-toggle='dropdown' aria-expanded='true' title='More options'>
                            		<i class="fal fa-ellipsis-v"></i>
                            	</a>
                            	<div class='dropdown-menu'>
                                    <a class='dropdown-item docaddwork'  data-objid='`+i.id+`' href='javascript:void(0);'> Thêm mới công việc</a>
                            		<a class='dropdown-item doceditfunc'data-objid='`+i.id+`'href='javascript:void(0); ' > Sửa </a>
                                    <a class='dropdown-item docdeletefunc'  data-objid='`+i.id+`' href='javascript:void(0);'> Xóa </a>
                            	</div>
                            </div>`:`                        
                            <div class='dropdown d-inline-block'>
                            	<a href='#'' class='btn btn-sm btn-icon btn-outline-primary rounded-circle shadow-0' data-toggle='dropdown' aria-expanded='true' title='More options'>
                            		<i class="fal fa-ellipsis-v"></i>
                            	</a>
                            	<div class='dropdown-menu'>
                            		<a class='dropdown-item doceditfunc'data-objid='`+i.id+`'href='javascript:void(0); ' > Sửa </a>
                                    <a class='dropdown-item docdeletefunc'  data-objid='`+i.id+`' href='javascript:void(0);'> Xóa </a>
                            	</div>
                            </div>`}},{orderable:!1,targets:1,data:"title"},]});abp.event.on("app.reloadDocTable",function(){u()});$("#Search").click(function(n){n.preventDefault();u()});$("#workGroupTable").on("click",".docaddwork",function(){var n=$(this),t={Id:n[0].dataset.objid};r.open(t)});$("#workGroupTable").on("click",".doceditfunc",function(){var t=$(this),n={Id:t[0].dataset.objid};console.log("aaa",n);e.open(n)});v();$("#CreateNewButtonxx").click(function(){l.open(1,function(n){y(n)})})})(jQuery);